{
    "contents" : "#### COP Data Analysis ####\n# This is a collaborative project between Dr. Eadric Bressel, Adam Raikes, Talin\n# Louder, and Devin Patterson. In this arm of the analysis, I will analyze the\n# raw X and Y COP data to examine the multiscale complexity of single and dual\n# task postural sway on land and water.\n\n# The data was provided to me as a .xlsx file with 4 tabs. Tabs 4 and 5 are the\n# COPx and Y. However, these are untidy data with blank columns to separate\n# conditions. Prior to computing multiscale entropy, this dataset requires\n# substantial cleaning.\n\n# This script is the second phase of analysis. MSE has alreay been computed on\n# the dataset. This analysis will employ a 2x2 repeated measures design. \n\n# To account for the possibility of nonstationarity in the data, the analysis\n# will look at both raw and detrended COP data.\n\n#### Load libraries ####\nlibrary(tidyverse)\nlibrary(nlme)\n\n#### Load MSE data ####\nmse.x <- read.csv(\"Data Files/MSE X.csv\", header = FALSE)\nmse.y <- read.csv(\"Data Files/MSE Y.csv\", header = FALSE)\nmse.x.detrended <- read.csv(\"Data Files/Detrended X MSE.csv\", header = FALSE)\nmse.y.detrended <- read.csv(\"Data Files/Detrended Y MSE.csv\", header = FALSE)\n\n#### Add subject indicators to each data frame\nmse.x <- mutate(mse.x, Participant = subject.vec)\nmse.y <- mutate(mse.y, Participant = subject.vec)\nmse.x.detrended <- mutate(mse.x.detrended, Participant = subject.vec)\nmse.y.detrended <- mutate(mse.y.detrended, Participant = subject.vec)\n\n#### Reshape to long and reformat the scale value column\nmse.x <- mse.x %>%\n  select(-V1) %>%\n  gather(Scale, MSE, -Participant) %>%\n  mutate(Direction = \"Medial-Lateral\",\n         Type = \"Raw\")\nmse.x$Scale <- as.numeric(gsub(\"V\",\"\", mse.x$Scale))\n\nmse.x.detrended <- mse.x.detrended %>%\n  select(-V1) %>%\n  gather(Scale, MSE, -Participant) %>%\n  mutate(Direction = \"Medial-Lateral\",\n         Type = \"Detrended\")\nmse.x.detrended$Scale <- as.numeric(gsub(\"V\",\"\", mse.x.detrended$Scale))\n\nmse.y <- mse.y %>%\n  select(-V1) %>%\n  gather(Scale, MSE, -Participant) %>%\n  mutate(Direction = \"Anterior-Posterior\",\n         Type = \"Raw\")\nmse.y$Scale <- as.numeric(gsub(\"V\",\"\", mse.y$Scale))\n\nmse.y.detrended <- mse.y.detrended %>%\n  select(-V1) %>%\n  gather(Scale, MSE, -Participant) %>%\n  mutate(Direction = \"Anterior-Posterior\",\n         Type = \"Detrended\")\nmse.y.detrended$Scale <- as.numeric(gsub(\"V\",\"\", mse.y.detrended$Scale))\n\n#### Join data frames in long format ####\nmse.data <- bind_rows(list(mse.x, mse.x.detrended, mse.y, mse.y.detrended))\n\n#### Split participant column ####\nmse.data <- extract(mse.data, Participant, into = c(\"Subject\", \"Environment\", \"Task\"),\n                    \"([0-2][0-9])([L|W])([S|D])\")\n\nstr(mse.data)\nmse.data <- mutate_at(mse.data, vars(Subject), funs(as.numeric))\n\n#### Split into ML and AP directions ####\nap.mse <- filter(mse.data, Direction == \"Anterior-Posterior\")\nml.mse <- filter(mse.data, Direction == \"Medial-Lateral\")\n\n#### Plot 2x2 frames for each direction ####\nggplot(data = ap.mse, aes(x = Scale, y = MSE, group = interaction(Task, Subject),\n                          color = Task)) +\n  facet_grid(Type ~ Environment) +\n  geom_line()\n\nggplot(data = ml.mse, aes(x = Scale, y = MSE, group = interaction(Task, Subject),\n                          color = Task)) +\n  facet_grid(Type ~ Environment) +\n  geom_line()\n\n\n\n",
    "created" : 1477941589906.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "599600326",
    "id" : "7D19CCCF",
    "lastKnownWriteTime" : 1478016645,
    "path" : "~/GitHub/COP Data/R Scripts/Entropy Analysis.R",
    "project_path" : "R Scripts/Entropy Analysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}